<!DOCTYPE html>
<html lang="ja">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ラブライブシリーズ声優DB</title>
    <script src="https://cdn.jsdelivr.net/npm/vue@2.6.12/dist/vue.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/dayjs/1.10.4/dayjs.min.js"
        integrity="sha512-0fcCRl828lBlrSCa8QJY51mtNqTcHxabaXVLPgw/jPA5Nutujh6CbTdDgRzl9aSPYW/uuE7c4SffFUQFBAy6lg=="
        crossorigin="anonymous"></script>
</head>

<body>
    <div id="app">
        <h1>ラブライブシリーズ声優一覧</h1>
        <p>工事中。年齢はこのページを開かれたタイミングで計算されているので常に最新です。(誕生日があっていれば)<br>年齢の確認ができます</p>
        グループで絞る：
        <select v-model="showGroup">
            <option disabled value="">グループ一覧</option>
            <option v-for="group in groups(actorInfo)" v-bind:value="group" v-bind:key="group">
                {{ group }}
            </option>
        </select>
        <button v-on:click="actorInfo = sortYear(actorInfo,true)">昇順</button>
        <button v-on:click="actorInfo = sortYear(actorInfo,false)">降順</button>
        <div v-for="actor in actorInfo" :key="actor.name">
            <p v-if="actor.group == showGroup || showGroup == `全て`" v-bind:class="convertGroupNameToRomaji(actor.group)"
                class="card">
                名前：{{actor.name}} <br>
                誕生日：{{ convertDate(actor.birth) }} <br>
                グループ：{{ actor.group }} <br>
                年齢: {{ year(actor.birth) }} <br>
                詳細： {{ actor.detail }}
            </p>
        </div>


    </div>
</body>
<script>
    var app = new Vue({
        el: "#app",
        data: {
            actorInfo: [],
            showGroup: "全て",
        },
        mounted: function () {
            fetch("./actorInfo.json")
                .then(response => response.json())
                .then(data => (this.actorInfo = this.sortYear(data, false)))
        },
        methods: {
            convertDate: function (date) {
                return dayjs(date).format('YYYY年MM月DD日')
            },
            // 年齢を返す
            year: function (date) {
                let month = dayjs().diff(dayjs(date), "month")
                return Math.floor(month / 12) + "歳" + month % 12 + "ヶ月"
            },
            // 年齢でソート
            sortYear: function (data, asc) {
                return data.sort((a, b) => {
                    if (asc) {
                        if (dayjs(a.birth).isAfter(dayjs(b.birth)))
                            return -1
                        else
                            return 1
                    } else {
                        if (dayjs(a.birth).isAfter(dayjs(b.birth)))
                            return 1
                        else
                            return -1
                    }
                })
            },
            // グループの一覧の文字列配列を返す
            groups: function (data) {
                let tmp = data.map(elm => { return elm.group }).filter((x, i, self) => {
                    return self.indexOf(x) === i;
                }).sort()
                tmp.unshift("全て")
                return tmp
            },
            // グループ名をローマ字に変換する（スタイル用）
            convertGroupNameToRomaji(group) {
                switch (group) {
                    case "μ's":
                        return "Muse"
                    case "虹ヶ咲学園スクールアイドル同好会":
                        return "Niji"
                    case "Saint Snow":
                        return "SS"
                    case "Liella!":
                        return "Liella"
                    default:
                        return group
                }
            }
        }
    })
</script>
<style>
    @import url(//fonts.googleapis.com/earlyaccess/notosansjapanese.css);

    html {
        font-family: "Noto Sans Japanese", "Hiragino Kaku Gothic ProN", Meiryo, sans-serif;
    }

    .Aqours {
        background-color: #3299e9;
    }

    .Muse {
        background-color: #e3007a;
    }

    .Niji {
        background-color: #f79905;
    }

    .SS {
        background-color: #b94456;
    }

    .Liella {
        background-color: #a5459c;
    }

    .card {
        padding: 1rem;
    }
</style>

</html>